{%- if section.settings.fullwidth -%}
	{%- assign container = 'container-full' -%}
{%- elsif section.settings.max_width != blank -%}
	{%- assign container = 'bwp-container' -%}
{%- else -%}
	{%- assign container = 'container' -%}
{%- endif -%}

{%- assign max_width = '' -%}
{%- if section.settings.fullwidth == blank and section.settings.max_width != blank -%}
	{%- capture max_width -%}style="max-width: {{ section.settings.max_width }};"{%- endcapture -%}
{%- endif -%}

{%- assign bg_setting = '' -%}
{%- if section.settings.bg_image != blank -%}
	{%- capture bg_setting -%}
		background-position:{{ section.settings.bg_position }};background-size:{{ section.settings.bg_size }};
		{%- if section.settings.bg_fixed != blank -%}
			background-attachment: fixed;
		{%- endif -%}
	{%- endcapture -%}
{%- endif -%}

{%- assign bg_full = '' -%}
{%- if section.settings.bg_image != blank and section.settings.bg_width == 'full' -%}
	{%- capture bg_full -%}
		style="background-image: url('{{ section.settings.bg_image | img_url: ''}}');{{ bg_setting }}"
	{%- endcapture -%}
{%- endif -%}

{%- assign bg_content = '' -%}
{%- if section.settings.bg_image != blank and section.settings.bg_width == 'content' -%}
	{%- capture bg_content -%}
		style="background-image: url('{{ section.settings.bg_image | img_url: ''}}');{{ bg_setting }}"
	{%- endcapture -%}
{%- endif -%}

{%- assign color_bg = section.settings.color_bg -%}
{%- assign image 		= section.settings.image -%}
{%- assign subtitle		= section.settings.sub_title -%}
{%- assign description 	= section.settings.description -%}
{%- assign title 		= section.settings.title -%}

{% assign width_content_left 	= section.settings.width_content_video | split: "|" %}
{% assign width_content_right 	= section.settings.width_content_image | split: "|" %}
{% assign margin 	= section.settings.margin | split: "|" %}
{% assign padding 	= section.settings.padding | split: "|" %}

{%- assign image_icon = section.settings.image_icon -%}
{%- assign color_icon = section.settings.color_icon -%}
{%- style -%}
	{%- if margin[0] != blank or padding[0] != blank -%}
		#shopify-section-{{ section.id }} .bwp-widget-lookbook-video{
			{%- if margin[0] != blank -%}margin: {{ margin[0] }};{%- endif -%}
			{%- if padding[0] != blank -%}padding:{{ padding[0] }};{%- endif -%}
		}
	{%- endif -%}
	#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-left{
		max-width:{{ width_content_left[0] }};flex: 0 0 {{ width_content_left[0] }};
	}
	#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-right{
		max-width:{{ width_content_right[0] }};flex: 0 0 {{ width_content_right[0] }};
	}
	@media (max-width:1200px){
		{%- if margin[1] != blank or padding[1] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video{
				{%- if margin[1] != blank -%}margin: {{ margin[1] }};{%- endif -%}
				{%- if padding[1] != blank -%}padding:{{ padding[1] }};{%- endif -%}
			}
		{%- endif -%}
		{%- if width_content_left[1] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-left{
				max-width:{{ width_content_left[1] }};flex: 0 0 {{ width_content_left[1] }};
			}
		{%- endif -%}
		{%- if width_content_right[1] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-right{
				max-width:{{ width_content_right[1] }};flex: 0 0 {{ width_content_right[1] }};
			}
		{%- endif -%}
	}
	@media (max-width:991px){
		{%- if margin[2] != blank or padding[2] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video{
				{%- if margin[2] != blank -%}margin: {{ margin[2] }};{%- endif -%}
				{%- if padding[2] != blank -%}padding:{{ padding[2] }};{%- endif -%}
			}
		{%- endif -%}
		{%- if width_content_left[2] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-left{
				max-width:{{ width_content_left[2] }};flex: 0 0 {{ width_content_left[2] }};
			}
		{%- endif -%}
		{%- if width_content_right[2] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-right{
				max-width:{{ width_content_right[2] }};flex: 0 0 {{ width_content_right[2] }};
			}
		{%- endif -%}
	}
	@media (max-width:767px){
		{%- if margin[3] != blank or padding[3] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video{
				{%- if margin[3] != blank -%}margin: {{ margin[3] }};{%- endif -%}
				{%- if padding[3] != blank -%}padding:{{ padding[3] }};{%- endif -%}
			}
		{%- endif -%}
		{%- if width_content_left[3] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-left{
				max-width:{{ width_content_left[3] }};flex: 0 0 {{ width_content_left[3] }};
			}
		{%- endif -%}
		{%- if width_content_right[3] != blank -%}
			#shopify-section-{{ section.id }} .bwp-widget-lookbook-video .content-right{
				max-width:{{ width_content_right[3] }};flex: 0 0 {{ width_content_right[3] }};
			}
		{%- endif -%}
	}
{%- endstyle -%}

<section class="kretoss-section bwp-widget-lookbook-video kretoss-section--lookbook kretoss-section--{{ section.id }}" {{ bg_full }} style="background-color:{{ color_bg }};">
	<div class="{{ container }}" {{ max_width }} >
		<div class="kretoss-section__inner" {{ bg_content }}>
			<div class="kretoss-section__content">
				<div class="content-left">
					<div class="content-width">
						{{ width_content[2] }}
						<div class="contact-form-video">
							{%- if subtitle != blank -%}
							<div class="bwp-image-subtitle" style="color:{{ section.settings.color_sub_title }}">{{ subtitle }}</div>
							{%- endif -%}
							{%- if title != blank -%}
							<h3 class="title-banner" style="color:{{ section.settings.color_title }}">{{ title }}</h3>
							{%- endif -%}
							{%- if description != blank -%}
							<div class="bwp-image-description" style="color:{{ section.settings.color_description }}">{{ description }}</div>
							{%- endif -%}
							{%- if section.settings.button -%}
								<a class="bwp-button" href="{{ section.settings.link_button }}">{{ section.settings.button }}</a>
							{%- endif -%}
						</div>
						<div class="policy-card__video";>
							<div class="bg-video-icon">
								<div class="bwp-image" >
									{%- if image -%}
									<img class="featured-banner__img lazyload fade-in" src="{{ image | img_url: 'master' }}" alt="{{ image.alt | escape }}"/>
									{%- else -%}
									{{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
									{%- endif -%}
								</div>
								<div class="video-icon">
									<div class="effect-video-icon" data-button-video>
										{%- if image_icon -%}
										{{ image_icon }}
										{%- endif -%}
										<span></span>
										<span></span>
										<span></span>
									</div>  
								</div>  
							</div>  
							<div class="kretoss__content-video">
								<div class="video-wrapper" >
								<div class="close-video" data-button-video></div>
								{%- if section.settings.video_url == blank -%}
									<iframe src="//www.youtube.com/embed/_9VUPq3SxOc?rel=0&showinfo=0&vq=720" width="850" height="480" frameborder="0" allowfullscreen></iframe>
								{%- else -%}
									{%- if section.settings.video_url.type == "youtube" -%}
									<iframe src="//www.youtube.com/embed/{{ section.settings.video_url.id }}?rel=0&showinfo=0&vq=720" width="850" height="480" frameborder="0" allowfullscreen></iframe>
									{%- endif -%}
									{%- if section.settings.video_url.type == "vimeo" -%}
									<iframe src="//player.vimeo.com/video/{{ section.settings.video_url.id }}?color={{ settings.color_secondary | remove: "#" }}&byline=0&portrait=0&badge=0" width="850" height="480" frameborder="0" allowfullscreen></iframe>
									{%- endif -%}
								{%- endif -%}
								</div>
							</div>
            			</div>
			    	</div>
				</div>
				<div class="content-right">
                    <div class="kretoss-lookbook__content">
                        {%- assign id = 0 -%}
                        {%- for block in section.blocks -%}
                            {% if block.type == 'image' %}
                                {%- assign j = 1 -%}
                                {%- assign i = 1 -%}
                                {%- assign image 		= block.settings.image -%}
                                {%- assign name 		= block.settings.title -%}
                                {% if block.settings.col_width != blank %}
                                    {% assign col_width 	= block.settings.col_width | split: "|" %}
                                {% endif %}
                                    <div class="kretoss-lookbook__item" {% if block.settings.col_width != blank %}style="--width-col:{{col_width[0]}};{%- if col_width[1] != blank -%}--width-col-lg:{{col_width[1]}};{%- endif -%}{%- if col_width[2] != blank -%}--width-col-md:{{col_width[2]}};{%- endif -%}{%- if col_width[3] != blank -%}--width-col-xs:{{col_width[3]}};{%- endif -%}"{% endif %}>
                                        <div class="lookbook-card">
                                            <div class="lookbook-image">
                                                {%- if image != blank -%}
                                                    {% include 'img-global' with image: image, class: "featured-lookbook__img", effect: "fade-in" %}
                                                {%- else -%}
                                                    {%- if section.settings.fullwidth -%}
                                                        <img class="lazyload fade-in" src="https://placehold.jp/1920x850.png" />
                                                    {%- else -%}
                                                        <img class="lazyload fade-in" src="https://placehold.jp/690x565.png" />
                                                    {%- endif -%}
                                                {%- endif -%}
                                            </div>
                                            {%- for block in section.blocks -%}
                                                {% if block.type == 'item' %}
                                                    {%- assign name_pin = block.settings.name_pin -%}
                                                    {%- assign product_handle = block.settings.product -%}
                                                    {%- assign top = block.settings.top -%}
                                                    {%- assign left = block.settings.left -%}
                                                    {% if name_pin == name %}
                                                        <div class="lookbook-card__item" style="top: {{ top }}%; left: {{ left }}%;">
                                                            <div class="lookbook-card__point">
                                                                <div class="lookbook-card__button">
                                                                    <button class="lookbook-card__btn" data-toggle="modal" data-target="lookbook-{{ section.id }}-{{ id }}">
                                                                        <span>{{ j }}</span>
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        {%- assign j = j | plus: 1 -%}
                                                        {%- assign id = id | plus: 1 -%}
                                                    {%- endif -%}
                                                {%- endif -%}
                                            {%- endfor -%}
                                        </div>
                                    </div>
                                {%- assign i = i | plus: 1 -%}
                            {%- endif -%}
                        {%- endfor -%}
                    </div>
				</div>
			</div>
		</div>
        {%- assign id = 0 -%}
        {%- for block in section.blocks -%}
            {% if block.type == 'item' %}
                {%- assign name_pin = block.settings.name_pin -%}
                {%- assign product_handle = block.settings.product -%}
                {%- assign alignment = block.settings.display -%}
                {%- render 'lookbook-item', product: all_products[product_handle], alignment: alignment, id: id -%}
                {%- assign id = id | plus: 1 -%}
            {%- endif -%}
        {%- endfor -%}
	</div>
</section>

{% schema %}
{
	"name": "Kretoss Lookbook Video",
	"class": "kretoss-framework",
	"settings": [
		{
			"type": "header",
			"content": "Layout settings"
		},
		{
			"type": "image_picker",
			"id": "bg_image",
			"label": "Background Image"
		},
        {
            "type": "color",
            "id": "color_bg",
            "label": "Background color",
            "default": "#f5f5f5"
        },
		{
			"type": "checkbox",
			"id": "bg_fixed",
			"label": "Background Fixed"
		},
		{
			"type": "text",
			"id": "bg_position",
			"label": "Background position",
			"default": "center"
		},
		{
			"type": "text",
			"id": "bg_size",
			"label": "Background size",
			"default": "cover"
		},
		{
			"type": "select",
			"id": "bg_width",
			"label": "Background Width",
			"options": [
				{
					"value": "full",
					"label": "Full"
				},
				{
					"value": "content",
					"label": "Content"
				}
			],
			"default": "full"
		},
		{
			"type": "text",
			"id": "max_width",
			"label": "Width container",
			"info": "Default: 1440px"
		},
		{
			"type": "checkbox",
			"id": "fullwidth",
			"label": "Fullwidth"
		},
		{
			"type": "text",
			"id": "padding",
			"label": "Padding",
			"placeholder": "0px 0px 0px 0px",
			"info":"Screen: desktop | 1200px | 991px | 767px"
		},
		{
			"type": "text",
			"id": "margin",
			"label": "Margin",
			"placeholder": "0px 0px 0px 0px",
			"info":"Screen: desktop | 1200px | 991px | 767px"
		},
		{
			"type": "header",
			"content": "General Settings"
		},
        {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
        },
		{
			"type": "html",
			"id": "image_icon",
			"label": "Icon"
		},
		{
			"type": "video_url",
			"id": "video_url",
			"label": "Video link",
			"accept": [
				"youtube",
				"vimeo"
			]
		},
        {
            "type": "text",
            "id": "sub_title",
            "label": "Sub Title"
        },
		{
			"type": "text",
			"id": "title",
			"label": "Title"
		},
        {
            "type": "textarea",
            "id": "description",
            "label": "Description"
        },
		{
			"type": "text",
			"id": "button",
			"label": "button"
		},
		{
			"type": "url",
			"id": "link_button",
			"label": "Link button"
		},
		{
			"type": "text",
			"id": "width_content_image",
			"default": "100%",
			"label": "Width content right",
			"info":"Screen: desktop | 1200px | 991px | 767px"
		},
		{
			"type": "text",
			"id": "width_content_video",
			"default": "100%",
			"label": "Width content left",
			"info":"Screen: desktop | 1200px | 991px | 767px"
		}
	],
     "blocks": [
			{
                "type": "image",
                "name": "Image Lookbook",
                "settings": [
					{
						"type": "text",
						"id": "title",
						"label": "Lookbook Name"
					},
                    {
						"type": "image_picker",
						"id": "image",
						"label": "Image"
					}
                ]
            },
            {
                "type": "item",
                "name": "Pin Product",
                "settings": [
					{
						"type": "text",
						"id": "name_pin",
						"label": "Pin for Image"
					},
                    {
                        "type": "product",
                        "id": "product",
                        "label": "Choose product"
                    },
                    {
                        "type": "select",
                        "id": "display",
                        "label": "Display type",
                        "default": "top-left",
                        "options": [
                            {
                                "value": "top-left",
                                "label": "Top left"
                            },
                            {
                                "value": "top-right",
                                "label": "Top right"
                            },
                            {
                                "value": "center-left",
                                "label": "Center left"
                            },
                            {
                                "value": "center-top",
                                "label": "Center top"
                            },
                            {
                                "value": "center-right",
                                "label": "Center right"
                            },
                            {
                                "value": "center-bottom",
                                "label": "Center bottom"
                            },
                            {
                                "value": "bottom-left",
                                "label": "Bottom left"
                            },
                            {
                                "value": "bottom-right",
                                "label": "Bottom right"
                            }
                        ]
                    },
                    {
                        "type": "range",
                        "id": "top",
                        "min": 0,
                        "max": 100,
                        "step": 1,
                        "unit": "%",
                        "label": "Offset top",
                        "default": 50
                    },
                    {
                        "type": "range",
                        "id": "left",
                        "min": 0,
                        "max": 100,
                        "step": 1,
                        "unit": "%",
                        "label": "Offset left",
                        "default": 50
                    }
                ]
            }
        ],
	"presets": [
		{
			"name": "Kretoss Lookbook Video",
			"category": "2. video"
		}
	]
}
{% endschema %}

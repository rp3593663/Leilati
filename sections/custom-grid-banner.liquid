{%- if section.settings.fullwidth -%}
  {%- assign container = 'container-full' -%}
{%- elsif section.settings.max_width != blank -%}
  {%- assign container = 'bwp-container' -%}
{%- else -%}
  {%- assign container = 'container' -%}
{%- endif -%}

{%- assign max_width = '' -%}
{%- if section.settings.fullwidth == blank and section.settings.max_width != blank -%}
  {%- capture max_width -%}style="max-width: {{ section.settings.max_width }};"{%- endcapture -%}
{%- endif -%}

{% assign margin  = section.settings.margin | split: "|" %}
{% assign padding = section.settings.padding | split: "|" %}

<style>
#shopify-section-{{ section.id }} .kretoss-section--custom-grid-banner{
  background-color: {{ section.settings.color_bg }};
  {% if margin[0] != blank %}margin: {{ margin[0] }};{% endif %}
  {% if padding[0] != blank %}padding: {{ padding[0] }};{% endif %}
}
@media (max-width:1200px){
  #shopify-section-{{ section.id }} .kretoss-section--custom-grid-banner{
    {% if margin[1] != blank %}margin: {{ margin[1] }};{% endif %}
    {% if padding[1] != blank %}padding: {{ padding[1] }};{% endif %}
  }
}
@media (max-width:991px){
  #shopify-section-{{ section.id }} .kretoss-section--custom-grid-banner{
    {% if margin[2] != blank %}margin: {{ margin[2] }};{% endif %}
    {% if padding[2] != blank %}padding: {{ padding[2] }};{% endif %}
  }
}
@media (max-width:767px){
  #shopify-section-{{ section.id }} .kretoss-section--custom-grid-banner{
    {% if margin[3] != blank %}margin: {{ margin[3] }};{% endif %}
    {% if padding[3] != blank %}padding: {{ padding[3] }};{% endif %}
  }
}
</style>

<section class="kretoss-section kretoss-section--custom-grid-banner {{ section.settings.custom_class }}">
  <div class="{{ container }}" {{ max_width }}>
    <div class="kretoss-section__inner">

      {% if section.settings.heading != blank %}
      <div class="kretoss_heading">
        <h2>
          {{ section.settings.heading }}
          {% if section.settings.heading_highlight != blank %}
            <span>{{ section.settings.heading_highlight }}</span>
          {% endif %}
        </h2>
      </div>
      {% endif %}

      <div class="custom_grid_banner_inner">
        {% for block in section.blocks %}
        <div class="inner_banner_box" {{ block.shopify_attributes }}>
          <div class="custom_banner_img">

            {% if block.settings.image != blank %}
              <img
                src="{{ block.settings.image | image_url: width: 900 }}"
                alt="{{ block.settings.title | escape }}"
                loading="lazy">
            {% endif %}

            <div class="custom_banner_content">
              {% if block.settings.link != blank %}
                <a href="{{ block.settings.link }}" class="content_title">
                  {{ block.settings.title }}
                </a>
                <a href="{{ block.settings.link }}" class="content_btn">
                  <svg width="32" height="18" viewBox="0 0 32 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M25 10H7C6.44 10 6 9.56 6 9C6 8.44 6.44 8 7 8H25C25.56 8 26 8.44 26 9C26 9.56 25.56 10 25 10Z" fill="black"/>
                    <path d="M20 17C19.9 17 19.7 16.9 19.3 16.7C18.9 16.3 18.9 15.7 19.3 15.3L25.6 9L19.3 2.7C18.9 2.3 18.9 1.7 19.3 1.3C19.7 0.9 20.3 0.9 20.7 1.3L27.7 8.3C28.1 8.7 28.1 9.3 27.7 9.7L20.7 16.7C20.5 16.9 20.2 17 20 17Z" fill="black"/>
                  </svg>
                </a>
              {% else %}
                <span class="content_title">{{ block.settings.title }}</span>
              {% endif %}
            </div>

          </div>
        </div>
        {% endfor %}
      </div>

      {% if section.settings.view_all_text != blank and section.settings.view_all_link != blank %}
      <div class="view_all_btn">
        <a href="{{ section.settings.view_all_link }}" class="theme_btn">
          {{ section.settings.view_all_text }}
        </a>
      </div>
      {% endif %}

    </div>
  </div>
</section>

{% schema %}
{
  "name": "Custom Grid Banner",
  "class": "kretoss-custom-grid-banner",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Shop by"
    },
    {
      "type": "text",
      "id": "heading_highlight",
      "label": "Highlighted Text",
      "default": "Category"
    },
    {
      "type": "text",
      "id": "custom_class",
      "label": "Custom CSS Class"
    },
    {
      "type": "color",
      "id": "color_bg",
      "label": "Background Color",
      "default": "#f5f5f5"
    },
    {
      "type": "text",
      "id": "max_width",
      "label": "Max Width",
      "info": "Example: 1440px"
    },
    {
      "type": "checkbox",
      "id": "fullwidth",
      "label": "Enable Full Width"
    },
    {
      "type": "text",
      "id": "padding",
      "label": "Padding",
      "info": "Desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "margin",
      "label": "Margin",
      "info": "Desktop | 1200px | 991px | 767px"
    },
    {
      "type": "text",
      "id": "view_all_text",
      "label": "View All Button Text",
      "default": "View All"
    },
    {
      "type": "url",
      "id": "view_all_link",
      "label": "View All Button Link"
    }
  ],
  "blocks": [
    {
      "type": "banner",
      "name": "Banner Item",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Banner Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Category Name"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link (Optional)"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Grid Banner",
      "blocks": [
        { "type": "banner" },
        { "type": "banner" },
        { "type": "banner" },
        { "type": "banner" }
      ]
    }
  ]
}
{% endschema %}
